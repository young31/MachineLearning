# Table of Contents

- [Dacon 월간 데이터 분석 - Starcraft2 승패예측](#dacon-월간-데이터-분석---starcraft2-승패예측)
    - [대회 summary](#대회-summary)
- [Code Review](#code-review)
    - [0) Intro](#0-intro)
    - [1) FE1](#1-fe1)
        - [자원](#자원)
        - [이벤트](#이벤트)
    - [2) FE1(img)](#2-fe1img)
    - [3) FE2](#3-fe2)
    - [4) FE2(cum)](#4-fe2cum)
    - [5) utils](#5-utils)
        - [build_lgb](#build_lgb)
        - [EDA](#eda)
        - [wr](#wr)
- [Outtro](#outtro)

# Dacon 월간 데이터 분석 - Starcraft2 승패예측

### 대회 summary

-   남은 기간 절반을 앞두고 마무리 결정
-   종료시점 기준 Public Score: 0.69x(roc_auc) 
    -    등수:12/569
-   최종등수: 
    -   0.68962
    -   23/684(public 30/684)

#### 자아비판

-   우승자들의 코드를 더 살펴봐야 겠지만 사용한 코드나 변수 등에 대해서는 크게 차이가 없어 보였음
    -   조그만 feature 변환/사용 부분이 결과를 만드는 것 같음
    -   역시나 유용한 lgb가 눈에 띄었음
-   초반 자원량에 집중한 부분이 발목을 잡았던 것인지..
-   새로 알게된 방법
    -   permutation importance
    -   fold마다 다른 feature selection 따로 설정해서 fold마다 나쁜 변수 빼기

## Code Review

### 0) Intro

-   처음 데이터를 받았을 때는 어떻게 처리하여야 할지 고민
-   이벤트 종류에 따라서 몇몇 세부 정보로 분류 가능하여 처리하여 feature로 결정

-   돈을 많이 번 쪽이 이기지 않을까?로 접근
-   **각 기록은 player0과 player1 및 두 선수의 차이 값을 사용**

### 1) FE1

-   기본적인 전처리(메모리 줄이기 및 nan처리) 후 feature 얻기위한 1차 코드

#### 자원

-   자원을 얻은 정보는 없기 때문에 자원축적정도를 tracking하기 위해 사용한 자원 선택
-   데에터를 뜯어본 결과 4가지 타입으로 자원을 소모
    -   유닛, 건물, 리서치(능력), 업그레이드
-   해당 정보를 수집하여 경기 끝난기준으로 정보를 얻음
-   이 후 경기시간을 고려하여 분당 평균 값으로도 변환하여 사용

**여담으로 해당정보를 얻기 위한 코드를 짜는데 초반에는 30분 -> 7분으로 단축**

#### 이벤트

-   자원소모외에 추가로 정보를 수집
-   attention: 얼마나 이벤트로그에 기록되었는가
    -   눈에 띄는 행동을 하면 더 많이 기록되었을 것이라는 생각에서 출발
    -   각 이벤트종류별로(8) 세분화하여 기록
    -   overall 기록은 apm이라는 이름으로 저장
-   atk: 공격 행동
    -   공격을 많이 하는 경우 승률이 높을 수 도 있을 것이라 판단

### 2) FE1(img)

-   위에서 사용한 정보 중 at과 Location에 해당하는 정보는 좌표를 가지고 있다는 것 확인
-   해당 정보를 지도에 mapping하여 사용할 수 있을까?
-   이벤트를 기록하여 시각화 할 수는 있었지만 너무 sparse한 부분이 많아 활용하지 못함

### 3) FE2

-   위에서 활용한 정보로 큰 이득을 얻지 못하여 정보 세분화 시작
-   기존 종료기준으로 작성한 정보를 분 단위로 분할하여 수집
-   데이터가 의도적으로 11분 이전자료로 압축되어 있어서 가능
-   사용하는 자료의 종류는 위와 동일

### 4) FE2(cum)

-   시간대별 자료를 수정하여 경기시간동안 누적자원량으로 수집
-   앞서 구한 자료와 일부 결합할 경우 score상승

### 5) utils

#### build_lgb

-   여러 분석모형에서 lgb가 좋은 모습을 보여준 만큼 이번에도 막강한 성능을 보여줌
-   bayesopt를 사용하여 hold-out방식으로 평가하여 하이퍼마라미터를 찾음
-   fit이 된 모델과 params를 return받을 수 있음

#### EDA

-   위 함수를 사용하여 feature selection하는 과정
-   lgb와 xgb는 default로 사용하며 추가로 모델을 작성하여 넘겨주면 해당 모델들도 계산
    -   fit 실행시 해당 모형들의 cross-val_score도 함께 작성하여 스태킹등에 활용할 수 있도록 함

#### wr

-   종족별 상대 승률을 기록함
-   해당 정보는 대부분의 경우 중요하게 작용(importance)

## Outtro

-   접근의 발상은 나쁘지 않았으나 주어진 자료를 고려하지 못했다고 평가
    -   전체 게임 로그가 주어진것이 아니라 의도적으로 일부만 제공
    -   이 과정에서 자원소모량을 제대로 tracking하지 못한 듯

-   FE/EDA까지 전부 참여한 대회였는데 생각보다 점수가 안나와서 아쉬웠던 대회
-   몇 차례 대회 참여하면서 모델링 기법에는 큰 성장이 없었던 것 같음
    -   기존방식:
        -   단순한 모형으로 데이터구조와 적합한 모델군 확보
        -   bagging/boosting 으로 성능 향상 및 모수최적화
        -   자료변형(PCA, LDA 등)
-   공부하고 있던 딥러닝 기반 기법들은 실 데이터에 적용하는 경우 크게 성능확보 못함
    -   다루었던 자료들이 unbalance하거나 수정된 경우라 더 심한듯
-   최종 앙상블/스태킹 모델의 경우 과적합이 너무 심하게 되어 사용하기 힘들었음
    -   이 후 시간이 되면 효율적인 스태킹 방법에 대해서 공부해봐야 겠음'
    -   중간중간 이 후 결합을 위해 자료를 만들어놓아야 나중에 편함